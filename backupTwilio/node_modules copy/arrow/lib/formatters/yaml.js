/**
 * This code is closed source and Confidential and Proprietary to
 * Appcelerator, Inc. All Rights Reserved.  This code MUST not be
 * modified, copied or otherwise redistributed without express
 * written permission of Appcelerator. This file is licensed as
 * part of the Appcelerator Platform and governed under the terms
 * of the Appcelerator license agreement.
 */

/**
 * Formats the body using YAML.
 * @param req
 * @param resp
 * @param body
 * @param singular
 * @param plural
 * @param callback
 */
exports.format = function yamlFormatter(req, resp, body, singular, plural, callback) {
	try {
		var yaml = require('js-yaml');
		body = body[plural] || body[singular] || body;
		body = JSON.parse(JSON.stringify(body));
		body = yaml.safeDump(body, {skipInvalid: true});
		resp && resp.set('Content-Type', 'text/yaml');
	}
	catch (E) {
		return callback(E);
	}
	callback(null, body.toString());
};

exports.extensions = ['yml', 'yaml'];
exports.defaultMimeType = 'text/yaml';
