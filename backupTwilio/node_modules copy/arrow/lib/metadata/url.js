/**
 * This code is closed source and Confidential and Proprietary to
 * Appcelerator, Inc. All Rights Reserved.  This code MUST not be
 * modified, copied or otherwise redistributed without express
 * written permission of Appcelerator. This file is licensed as
 * part of the Appcelerator Platform and governed under the terms
 * of the Appcelerator license agreement.
 */
var _ = require('lodash');

exports = module.exports = URL;

/**
 * A URL type.
 * @param obj
 * @returns {*}
 * @constructor
 */
function URL(obj) {
	return _.merge({
		subtype: 'url',
		type: 'text',
		required: false,
		default: '',
		validator: validator
	}, obj);
}

// URL validator
var validator = new RegExp(
	'^' +
		// protocol identifier (optional) + //
	'(?:(?:https?:)?//)?' +
		// user:pass authentication (optional)
	'(?:\\S+(?::\\S*)?@)?' +
		// host (optional) + domain + tld
	'(?:(?!-)[-a-z0-9\\u00a1-\\uffff]*[a-z0-9\\u00a1-\\uffff]+(?!./|\\.$)\\.?){2,}' +
		// server port number (optional)
	'(?::\\d{2,5})?' +
		// resource path (optional)
	'(?:/\\S*)?' +
	'$', 'i'
);
