module.exports = function (grunt) {

	// Project configuration.
	grunt.initConfig({
		appcJs: {
			src: ['*.js', 'lib/**/*.js', 'test/**/*.js', '!lib/admin/{jquery,bootstrap}/**/*']
		},
		mocha_istanbul: {
			coverage: {
				src: 'test',
				options: {
					timeout: 40000,
					ignoreLeaks: false,
					mochaOptions: ['--bail'],
					check: {
						statements: 60,
						branches: 30,
						functions: 40,
						lines: 60
					}
				}
			}
		},
		clean: {
			pre: ['*.log'],
			post: ['tmp']
		}
	});

	// Load grunt plugins for modules
	grunt.loadNpmTasks('grunt-appc-js');
	grunt.loadNpmTasks('grunt-mocha-istanbul');
	grunt.loadNpmTasks('grunt-contrib-clean');

	// Set required env vars
	grunt.registerTask('env', function () {
		process.env.TEST = '1';
	});

	grunt.registerTask('default', [
		'clean:pre',
		'env',
		'appcJs',
		'mocha_istanbul:coverage',
		'clean:post'
	]);
};
